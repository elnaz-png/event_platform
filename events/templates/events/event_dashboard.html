<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯: {{ event.title }}</title>
    <style>
        body { font-family: Tahoma, Arial; padding: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: center; }
        th { background-color: #f2f2f2; }
        .stat-box { display: inline-block; width: 200px; padding: 20px; background: #e8f4f8; margin-left: 20px; text-align: center; border-radius: 8px; }
    </style>
</head>
<body>
    <h1>Ù…Ø¯ÛŒØ±ÛŒØª Ø±ÙˆÛŒØ¯Ø§Ø¯: {{ event.title }}</h1>
    <a href="{% url 'events:detail' event.pk %}">Ù…Ø´Ø§Ù‡Ø¯Ù‡ ØµÙØ­Ù‡ Ø±ÙˆÛŒØ¯Ø§Ø¯</a> | 
    <a href="{% url 'events:list' %}">Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù„ÛŒØ³Øª</a>
    
    <hr>
    <h1>Ù…Ø¯ÛŒØ±ÛŒØª Ø±ÙˆÛŒØ¯Ø§Ø¯: {{ event.title }}</h1>
    
    <div style="margin: 20px 0;">
        <a href="{% url 'events:update' event.pk %}" style="background-color: #ffc107; color: black; padding: 8px 15px; border-radius: 5px; text-decoration: none;">
            âœï¸ ÙˆÛŒØ±Ø§ÛŒØ´ Ø±ÙˆÛŒØ¯Ø§Ø¯
        </a>
        
        <a href="{% url 'events:delete' event.pk %}" style="background-color: #dc3545; color: white; padding: 8px 15px; border-radius: 5px; text-decoration: none; margin-right: 10px;">
            ğŸ—‘ï¸ Ø­Ø°Ù Ø±ÙˆÛŒØ¯Ø§Ø¯
        </a>
    </div>

    <hr>
    <div>
        <div class="stat-box">
            <h3>ØªØ¹Ø¯Ø§Ø¯ Ø¨Ù„ÛŒØ· ÙØ±ÙˆØ®ØªÙ‡ Ø´Ø¯Ù‡</h3>
            <p style="font-size: 24px; font-weight: bold;">{{ total_sold }}</p>
        </div>
        <div class="stat-box">
            <h3>Ø¯Ø±Ø¢Ù…Ø¯ Ú©Ù„</h3>
            <p style="font-size: 24px; font-weight: bold;">{{ total_revenue }} ØªÙˆÙ…Ø§Ù†</p>
        </div>
    </div>

    <h2>Ù„ÛŒØ³Øª Ø´Ø±Ú©Øªâ€ŒÚ©Ù†Ù†Ø¯Ú¯Ø§Ù†</h2>
    {% if tickets %}
        <table>
            <thead>
                <tr>
                    <th>Ù†Ø§Ù… Ø®Ø±ÛŒØ¯Ø§Ø±</th>
                    <th>ØªØ¹Ø¯Ø§Ø¯ Ù†ÙØ±Ø§Øª</th>
                    <th>Ù…Ø¨Ù„Øº Ù¾Ø±Ø¯Ø§Ø®ØªÛŒ</th>
                    <th>Ø²Ù…Ø§Ù† Ø®Ø±ÛŒØ¯</th>
                    <th>Ú©Ø¯ Ø¨Ù„ÛŒØ·</th>
                </tr>
            </thead>
            <tbody>
                {% for ticket in tickets %}
                    <tr>
                        <td>{{ ticket.buyer.username }}</td>
                        <td>{{ ticket.quantity }}</td>
                        <td>{{ ticket.final_price }} ØªÙˆÙ…Ø§Ù†</td>
                        <td>{{ ticket.registered_at|date:"Y/m/d H:i" }}</td>
                        <td style="font-family: monospace;">{{ ticket.ticket_code }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>Ù‡Ù†ÙˆØ² Ø¨Ù„ÛŒØ·ÛŒ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ø±ÙˆÛŒØ¯Ø§Ø¯ ÙØ±ÙˆØ®ØªÙ‡ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</p>
    {% endif %}
    <hr style="margin: 40px 0;">

    <div style="display: flex; justify-content: space-between; align-items: center;">
        <h2>ğŸ·ï¸ Ú©Ø¯Ù‡Ø§ÛŒ ØªØ®ÙÛŒÙ Ø§ÛŒÙ† Ø±ÙˆÛŒØ¯Ø§Ø¯</h2>
        <a href="{% url 'discounts:create' event.pk %}" style="background-color: #17a2b8; color: white; padding: 8px 15px; border-radius: 5px; text-decoration: none;">
            + Ø§ÙØ²ÙˆØ¯Ù† Ú©Ø¯ ØªØ®ÙÛŒÙ Ø¬Ø¯ÛŒØ¯
        </a>
    </div>

    {% if event.discount_codes.all %}
        <table>
            <thead>
                <tr>
                    <th>Ú©Ø¯</th>
                    <th>Ø¯Ø±ØµØ¯</th>
                    <th>ÙˆØ¶Ø¹ÛŒØª</th>
                    <th>Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ø§Ø³ØªÙØ§Ø¯Ù‡</th>
                    <th>Ø¹Ù…Ù„ÛŒØ§Øª</th>
                </tr>
            </thead>
            <tbody>
                {% for discount in event.discount_codes.all %}
                    <tr>
                        <td style="font-weight: bold; font-family: monospace; font-size: 1.1em;">{{ discount.code }}</td>
                        <td>{{ discount.percent }}%</td>
                        <td>
                            {% if discount.is_active %}
                                <span style="color: green;">ÙØ¹Ø§Ù„ âœ…</span>
                            {% else %}
                                <span style="color: red;">ØºÛŒØ±ÙØ¹Ø§Ù„ âŒ</span>
                            {% endif %}
                        </td>
                        <td>{{ discount.usage_limit|default:"Ù†Ø§Ù…Ø­Ø¯ÙˆØ¯" }}</td>
                        <td>
                            <a href="{% url 'discounts:delete' discount.pk %}" style="color: red; font-size: 0.9em;">Ø­Ø°Ù</a>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p style="background-color: #f9f9f9; padding: 10px; border-radius: 5px;">Ù‡ÛŒÚ† Ú©Ø¯ ØªØ®ÙÛŒÙÛŒ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ø±ÙˆÛŒØ¯Ø§Ø¯ ØªØ¹Ø±ÛŒÙ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</p>
    {% endif %}

</body>
</html>